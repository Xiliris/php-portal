<div class="wrapper">
    {{navbar}}
    <main>
        <div class="audio-container">
            <h1 id="h1el">Celebrity Profile Audio</h1>
        </div>
    </main>
    {{footer}}
</div>

<script>
    async function loadAudio() {
        const queryParams = new URLSearchParams(window.location.search);
        const profileId = queryParams.get("id");

        if (profileId) {
            const audioUrl = `/api/routes/profile.php?id=${profileId}`;
            const audioResponse = await fetch(audioUrl);
            const audioData = await audioResponse.json();

            if (audioData.status === "success") {
                const audioPaths = audioData.profile.audio;

                if (Array.isArray(audioPaths) && audioPaths.length > 0) {
                    const audioContainer = document.querySelector(".audio-container");
                    audioContainer.innerHTML = '<h1 id="h1el">Celebrity Profile Audio</h1>';

                    audioPaths.forEach(path => {
                        const cleanPath = path.replace("../routes/uploads/audios/", "");
                        const audioElement = document.createElement("audio");
                        const audioFileName = document.createElement("p");

                        audioElement.controls = true;
                        audioElement.src = `/api/routes/uploads/audios/${cleanPath}`;
                        audioFileName.textContent = cleanPath.split('/').pop();

                        audioContainer.appendChild(audioFileName);
                        audioContainer.appendChild(audioElement);
                    });
                } else {
                    console.error("No audio paths found or audio paths is not an array.");
                    document.querySelector(".audio-container").innerHTML = '<p>No audio files available.</p>';
                }
            } else {
                console.error(audioData.message);
                document.querySelector(".audio-container").innerHTML = `<p>${audioData.message}</p>`;
            }
        }
    }

    loadAudio();
</script>

<style>
    html,
    body {
        height: 100%;
        margin: 0;
    }

    .wrapper {
        display: flex;
        flex-direction: column;
        min-height: 100vh;
    }

    main {
        flex: 1;
    }

    footer {
        margin-top: auto;
    }

    #h1el {
        padding-top: 30%;
        margin-bottom: 5%;
        text-align: center;
        font-size: 1.5em;
    }

    .audio-container {
        padding: 20px 10%;
        margin-bottom: 50px;
        display: flex;
        flex-direction: column;
        align-items: center;
    }

    audio {
        width: 80%;
        max-width: 800px;
        border: 1px solid #ccc;
        border-radius: 10px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    }

    p {
        margin: 10px 0;
        font-size: 1em;
        text-align: center;
    }

    @media (min-width: 344px) {
        #h1el {
            font-size: 1.5em;
        }
    }

    @media (min-width: 768px) {
        #h1el {
            font-size: 2em;
        }
    }

    @media (min-width: 1024px) {
        #h1el {
            font-size: 2.5em;
            padding-top: 10%;
        }
    }

    @media (min-width: 1280px) {
        #h1el {
            font-size: 3em;
        }
    }
</style>