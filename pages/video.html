<div class="wrapper">
    {{navbar}}
    <main>
        <div class="video-container">
            <h1 id="h1el">Celebrity Profile Videos</h1>
        </div>
    </main>
    {{footer}}
</div>

<script>
    async function loadVideo() {
        const queryParams = new URLSearchParams(window.location.search);
        const profileId = queryParams.get("id");

        if (profileId) {
            const videoUrl = `/api/routes/profile.php?id=${profileId}`;
            const videoResponse = await fetch(videoUrl);
            const videoData = await videoResponse.json();

            if (videoData.status === "success") {
                const videoPaths = videoData.profile.video;

                if (Array.isArray(videoPaths) && videoPaths.length > 0) {
                    const videoContainer = document.querySelector(".video-container");

                    videoContainer.innerHTML = '<h1 id="h1el">Celebrity Profile Videos</h1>';

                    videoPaths.forEach(path => {
                        const cleanPath = path.replace("../routes/", "");
                        const videoElement = document.createElement("video");
                        const videoFileName = document.createElement("p");

                        videoElement.controls = true;
                        videoElement.src = `/api/routes/${cleanPath}`;
                        videoFileName.textContent = cleanPath.split('/').pop();

                        videoContainer.appendChild(videoFileName);
                        videoContainer.appendChild(videoElement);
                    });
                } else {
                    console.error("No video paths found or video paths is not an array.");
                    document.querySelector(".video-container").innerHTML = '<p>No videos available.</p>';
                }
            } else {
                console.error(videoData.message);
                document.querySelector(".video-container").innerHTML = `<p>${videoData.message}</p>`;
            }
        }
    }

    loadVideo();
</script>

<style>
    html,
    body {
        height: 100%;
        margin: 0;
    }

    .wrapper {
        display: flex;
        flex-direction: column;
        min-height: 100vh;
    }

    main {
        flex: 1;
    }

    footer {
        margin-top: auto;
    }

    .video-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 20px;
    }

    video {
        max-width: 90%;
        height: auto;
        margin: 10px 0;
    }

    p {
        margin: 10px 0;
        font-size: 1em;
        text-align: center;
    }

    #h1el {
        font-size: 1.5em;
        padding-top: 5%;
        margin-bottom: 20px;
        text-align: center;
    }

    @media (min-width: 344px) {
        video {
            max-width: 100%;
        }

        #h1el {
            font-size: 1.5em;
            padding-top: 30%;
        }
    }

    @media (min-width: 768px) {
        video {
            max-width: 80%;
        }

        #h1el {
            font-size: 2.2em;
            padding-top: 20%;
        }
    }

    @media (min-width: 1024px) {
        video {
            max-width: 60%;
        }

        #h1el {
            font-size: 2.8em;
            padding-top: 15%;
        }
    }

    @media (min-width: 1280px) {
        video {
            max-width: 50%;
        }

        #h1el {
            font-size: 3.2em;
            padding-top: 10%;
        }
    }
</style>