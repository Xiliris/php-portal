{{navbar}}
<div id="dashboard">
  <div>
    <h1 id="h1el">Admin Dashboard</h1>
  </div>
  <br>

  <body>
    <h1>Create Celebrity Profile</h1>
    <br>
    <form id="profile-form" enctype="multipart/form-data" action="/api/routes/create_profile.php" method="post">
      <label for="picture">Profile Picture:</label>
      <input type="file" name="picture" id="picture" accept="image/*">
      <br>
      <br>
      <label for="bio">Bio:</label>
      <br>
      <textarea name="bio" id="bio" rows="10" cols="60"></textarea>
      <br>
      <label for="profile_documents">Profile Documents:</label>
      <input type="file" name="profile_documents[]" id="profile_documents" multiple accept=".pdf, .doc, .docx">
      <br>
      <br>
      <input type="submit" value="Create Profile">
    </form>

    <div id="error-message"></div>
  </body>
</div>
{{footer}}

<script>
  document.getElementById('profile-form').addEventListener('submit', async function (event) {
    event.preventDefault();

    const form = event.target;
    const formData = new FormData(form);

    try {
      const response = await fetch('/api/routes/create_profile.php', {
        method: 'POST',
        body: formData,
      });

      const contentType = response.headers.get('content-type');
      if (contentType && contentType.includes('application/json')) {
        const result = await response.json();
        if (result.status === 'success') {
          document.getElementById('error-message').textContent = `Success: ${result.message}`;
          if (result.profileId) {
            window.location.href = `/profile?id=${result.profileId}`;
          } else {
            document.getElementById('error-message').textContent = "No profile ID returned.";
          }
        } else {
          document.getElementById('error-message').textContent = result.message ? `${result.message}` : 'An unknown error occurred.';
        }
      } else {
        throw new Error('Invalid JSON response');
      }
    } catch (error) {
      document.getElementById('error-message').textContent = `${error.message}`;
    }
  });
</script>

<style>
  #dashboard {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    margin-top: 0 auto;
  }

  #h1el {
    margin-top: 55%;
    margin-bottom: 40%;
    text-align: center;
  }

  #profile-form {
    margin-bottom: 1%;
  }

  #error-message {
    color: red;
    margin-bottom: 20%;
  }
</style>